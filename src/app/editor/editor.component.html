<app-toolbar (onNewNodeClicked)="generateNewNode()"
             (onBackToOriginClicked)="panToOrigin()"
             (onHelpClicked)="showHelpModal()"
             (onLoadClicked)="load()"
             (onSaveClicked)="save()"
             (onDialogeNameChange)="changeDialogeName($event)"></app-toolbar>

<app-canvas></app-canvas>


<app-modal *ngIf="helpModalVisible"
           (onClose)="hideAllModals();">
    <app-help-modal></app-help-modal>
</app-modal>

<app-context-menu (onNewNode)="generateNewNode($event)"
                  (onNewComment)="generateNewComment($event)"
                  (onNewEventNode)="generateNewEventNode($event)"
                  (onNewConditionNode)="generateNewConditionNode($event)"></app-context-menu>

<app-variable-panel></app-variable-panel>
<app-character-panel></app-character-panel>

<pan-zoom [config]="panZoomConfig"
          (contextmenu)="openContextMenu($event)">

    <span *ngIf="dialogue$ | async as dialogue">
        <app-background></app-background>

        <app-gui-element *ngFor="let node of dialogue.nodes"
                         [guiElement]="node">

            <app-node (onUpdate)="updateNode($event)"
                      (onDelete)="deleteNode($event)"
                      [dialogueNode]="node"></app-node>

        </app-gui-element>

        <app-gui-element *ngFor="let comment of dialogue.comments"
                         [guiElement]="comment">

            <app-comment (onUpdate)="updateComment($event)"
                         (onDelete)="deleteComment($event)"
                         [comment]="comment"></app-comment>
        </app-gui-element>

        <app-gui-element *ngFor="let event of dialogue.events"
                         [guiElement]="event">

            <app-event (onUpdate)="updateEventNode($event)"
                       (onDelete)="deleteEventNode($event)"
                       [eventNode]="event"></app-event>

        </app-gui-element>

        <app-gui-element *ngFor="let condition of dialogue.conditions"
                         [guiElement]="condition">

            <app-condition (onUpdate)="updateConditionNode($event)"
                           (onDelete)="deleteConditionNode($event)"
                           [conditionNode]="condition"></app-condition>
        </app-gui-element>

    </span>
</pan-zoom>